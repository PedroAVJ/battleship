"use strict";(self["webpackChunkbattleship"]=self["webpackChunkbattleship"]||[]).push([[484],{8533:function(t,n,e){e.d(n,{$x:function(){return d},NU:function(){return a},_1:function(){return v},_Q:function(){return p},_v:function(){return i},bw:function(){return g},cD:function(){return w},f0:function(){return s},gg:function(){return y},gr:function(){return f},hk:function(){return S},m9:function(){return h},we:function(){return b},zA:function(){return m}});e(7658);var r=e(8897),o=e(1084);function i(t){return new Promise((n=>setTimeout(n,t)))}function a(t){let n=!0;return Object.values(r.JY).forEach((e=>{t[e].guiCount>0&&(n=!1)})),n}function s(t){if(0===t.length)return!1;if(0===t[0].length)return!1;for(const n of t)for(const t of n)if(t.shipHitbox&&!t.contains.successfulShot)return!1;return!0}function c(t){for(const n of t)for(const t of n)if(!y(t))return!0;return!1}function l(t){if(s(t))throw new Error("Game is over, cannot make a move.");if(!c(t))throw new Error("No valid moves available.");const n=Math.floor(Math.random()*t.length),e=Math.floor(Math.random()*t[0].length);return y(t[n][e])?l(t):{row:n,col:e}}function u(t,n){const e=[];for(let i=0;i<o.y[t].length;i++)for(let a=0;a<o.y[t].width;a++)n===r.i5.HORIZONTAL&&e.push({row:a,col:i}),n===r.i5.VERTICAL&&e.push({row:i,col:a});return e}function f(t,n,e,r,o){const i=u(n,e);for(const a of i){if(a.row+r>=t.length)return!0;if(a.col+o>=t[0].length)return!0;const n=t[a.row+r][a.col+o];if(y(n))return!0;if(n.shipHitbox)return!0}return!1}function h(t,n,e,r,o){if(f(t,n,e,r,o))throw new Error("Invalid ship placement.");const i=u(n,e);for(const a of i){const i=t[a.row+r][a.col+o];i.shipHitbox=n;const s=0===a.row&&0===a.col;s&&(i.shipSprite={name:n,orientation:e,isPreview:!1})}}function d(t,n){n.forEach((n=>{for(let e=0;e<o.y[n].count;e++)while(1){const e=Math.floor(Math.random()*t.length),o=Math.floor(Math.random()*t[0].length),i=Math.random()<.5?r.i5.HORIZONTAL:r.i5.VERTICAL;if(!f(t,n,i,e,o)){h(t,n,i,e,o);break}}}))}function p(t,n){for(const e of t)for(const t of e)t.shipHitbox&&t.shipHitbox===n&&(t.contains.uncoveredShip=!0)}function g(t,n,e){for(let r=n-1;r<=n+1;r++)for(let n=e-1;n<=e+1;n++){if(r<0||r>=t.length)continue;if(n<0||n>=t[0].length)continue;const e=t[r][n];y(e)||(e.shipHitbox?e.contains.uncoveredShip=!0:e.contains.missedShot=!0)}}function m(t,n,e){for(let r=n-1;r<=n+1;r++)for(let n=e-1;n<=e+1;n++)S(t,r,n)}function S(t,n,e){if(n<0||n>=t.length)return;if(e<0||e>=t[0].length)return;const r=t[n][e];y(r)||(r.shipHitbox?r.contains.successfulShot=!0:r.contains.missedShot=!0)}function y(t){const n=t.background.isLand||t.background.isOutOfBounds||t.contains.missedShot||t.contains.successfulShot;return n}function b(t){if(!t[r.JY.BATTLESHIP].hasUsedAbility){const n=t[r.JY.BATTLESHIP].health;let e=.05;if(3===n?e=.1:2===n?e=.4:1===n&&(e=.8),Math.random()<e)return void(t[r.JY.BATTLESHIP].isUsingAbility=!0)}if(!t[r.JY.SUBMARINE].hasUsedAbility&&Math.random()<.1)t[r.JY.SUBMARINE].isUsingAbility=!0;else if(!t[r.JY.AIRCRAFT_CARRIER].hasUsedAbility){const n=t[r.JY.AIRCRAFT_CARRIER].health;let e=.05;if(6===n?e=.1:5===n?e=.15:4===n?e=.2:3===n?e=.3:2===n?e=.6:1===n&&(e=.9),Math.random()<e)return void(t[r.JY.AIRCRAFT_CARRIER].isUsingAbility=!0)}}function v(t){const n=[];for(let a=0;a<t.board.length;a++){n.push([]);for(let e=0;e<t.board[0].length;e++)n[a].push(0)}let e=JSON.parse(JSON.stringify(t.board));for(const a of e)for(const n of a)if(n.shipHitbox){n.shipSprite=void 0;const e=n.shipHitbox;0===t[e].health&&(n.contains.successfulShot=!1,n.contains.missedShot=!0),n.shipHitbox=void 0}for(let a=0;a<e.length;a++)for(let t=0;t<e[0].length;t++){const r=e[a][t];if(y(r))continue;let o=0;for(let n=a-1;n>=0;n--){if(!e[n][t].contains.successfulShot)break;o++}let i=0;for(let n=a+1;n<e.length;n++){if(!e[n][t].contains.successfulShot)break;i++}let s=0;for(let n=t-1;n>=0;n--){if(!e[a][n].contains.successfulShot)break;s++}let c=0;for(let n=t+1;n<e[0].length;n++){if(!e[a][n].contains.successfulShot)break;c++}n[a][t]=Math.max(o,i,s,c)}let r=0,o=-1,i=-1;for(let a=0;a<n.length;a++)for(let t=0;t<n[0].length;t++)n[a][t]>r&&(r=n[a][t],o=a,i=t);return 0===r?l(t.board):{row:o,col:i}}function w(t){const n=1e3,e=[];for(let r=0;r<t.board.length;r++){e.push([]);for(let n=0;n<t.board[0].length;n++)e[r].push(0)}const i=[];Object.values(r.JY).forEach((n=>{t[n].health>0&&i.push(n)})),i.sort(((t,n)=>{const e=o.y[t].length*o.y[t].width,r=o.y[n].length*o.y[n].width;return r-e}));let a=JSON.parse(JSON.stringify(t.board));for(const r of a)for(const t of r)t.shipHitbox=void 0,t.shipSprite=void 0;for(let r=0;r<n;r++){const t=JSON.parse(JSON.stringify(a));d(t,i);for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++){const o=t[n][r];o.shipHitbox&&e[n][r]++}}for(let r=0;r<e.length;r++)for(let t=0;t<e[0].length;t++)e[r][t]/=n;let s=0,c=-1,u=-1;for(let r=0;r<e.length;r++)for(let t=0;t<e[0].length;t++)e[r][t]>s&&(s=e[r][t],c=r,u=t);return 0===s?l(t.board):{row:c,col:u}}},3730:function(t,n,e){e.d(n,{Z:function(){return g}});var r=e(3396),o=e(4870),i=e(7139),a=e(9242),s=e(4299),c=e(7627),l=e(8533);const u={class:"board-wrapper"},f=["onDragenter","onDragleave","onDrop","onTouchstart","onTouchend"];var h=(0,r.aZ)({__name:"PlayerBoard",setup(t){const n=(0,c.o)();let e=null;function h(t,n,r){e=t.target,g(t,n,r)}function d(t,n,r){e===t.target&&(S(t,n,r),e=null)}function p(t){return t.background.isWater?"water":t.background.isLand?"land":t.background.isOutOfBounds?"out-of-bounds":void 0}function g(t,e,r){if(!(t.target instanceof HTMLElement))return;const o=n.currentlyDraggedShip?.name,i=n.currentlyDraggedShip?.orientation;if(!o||!i)return;const a=n.player.board;(0,l.gr)(a,o,i,e,r)||(a[e][r].shipSprite={name:o,orientation:i,isPreview:!0},t.target.classList.add("darken"))}function m(t,e,r){if(!(t.target instanceof HTMLElement))return;const o=n.currentlyDraggedShip?.name,i=n.currentlyDraggedShip?.orientation;if(!o||!i)return;const a=n.player.board;(0,l.gr)(a,o,i,e,r)||(a[e][r].shipSprite=void 0,t.target.classList.remove("darken"))}function S(t,e,r){if(!(t.target instanceof HTMLElement))return;const o=n.currentlyDraggedShip?.name,i=n.currentlyDraggedShip?.orientation;if(!o||!i)return;const a=n.player.board;(0,l.gr)(a,o,i,e,r)||((0,l.m9)(a,o,i,e,r),n.setPlayerShipGUICount(o,n.player[o].guiCount-1),t.target.classList.remove("darken"))}return(t,e)=>((0,r.wg)(),(0,r.iD)("div",u,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,o.SU)(n).player.board,((t,n)=>((0,r.wg)(),(0,r.iD)("div",{key:n,class:"board-row"},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t,((t,o)=>((0,r.wg)(),(0,r.iD)("div",{key:o,class:"board-cell"},[(0,r._)("div",{class:(0,i.C_)(p(t)),onDragenter:t=>g(t,n,o),onDragleave:t=>m(t,n,o),onDragover:e[0]||(e[0]=(0,a.iM)((()=>{}),["prevent"])),onDrop:t=>S(t,n,o),onTouchstart:t=>h(t,n,o),onTouchend:t=>d(t,n,o)},[(0,r.Wm)(s.Z,{tile:t},null,8,["tile"])],42,f)])))),128))])))),128))]))}}),d=e(89);const p=(0,d.Z)(h,[["__scopeId","data-v-61b0d520"]]);var g=p},6786:function(t,n,e){e.r(n),e.d(n,{default:function(){return J}});e(7658);var r=e(3396),o=e(4870),i=e(7139),a=e(7627),s=e(8897),c=e(1084);const l=["id"],u={class:"secondary-text"},f={class:"secondary-text"},h={class:"secondary-text"};var d=(0,r.aZ)({__name:"ShipItem",props:{shipName:null},setup(t){const n=t,e=(0,a.o)(),d=(0,o.iH)(s.i5.HORIZONTAL),p=(0,o.iH)(null);function g(t){t.target instanceof HTMLElement&&e.setCurrentlyDraggedShip(n.shipName,d.value)}function m(t){t.target instanceof HTMLElement&&e.setCurrentlyDraggedShip(n.shipName,d.value)}function S(t){t.target instanceof HTMLElement&&(t.target.style.position="",t.target.style.left="",t.target.style.top="",t.target.style.zIndex="")}function y(){d.value===s.i5.HORIZONTAL?d.value=s.i5.VERTICAL:d.value=s.i5.HORIZONTAL}return(0,r.YP)((()=>e.currentlyDraggedShip?.name),(t=>{t===n.shipName?p.value?.classList.add("selected"):p.value?.classList.remove("selected")})),(a,s)=>(0,o.SU)(e).player[t.shipName].guiCount>0?((0,r.wg)(),(0,r.iD)("div",{key:0,id:t.shipName,class:"secondary-background"},[(0,r._)("h2",u,(0,i.zw)(t.shipName),1),(0,r._)("div",{ref_key:"svgContainer",ref:p,class:"svg-container",draggable:"true",onDragstart:g,onTouchstart:m,onTouchend:S},[(0,r.WI)(a.$slots,"default")],544),(0,r._)("span",f," Size: "+(0,i.zw)((0,o.SU)(c.y)[n.shipName].length)+" x "+(0,i.zw)((0,o.SU)(c.y)[n.shipName].width),1),(0,r._)("button",{class:(0,i.C_)(["primary-button",d.value]),onClick:y},(0,i.zw)(d.value),3),(0,r._)("span",h," Count: x"+(0,i.zw)((0,o.SU)(e).player[t.shipName].guiCount),1)],8,l)):(0,r.kq)("",!0)}}),p=e(89);const g=(0,p.Z)(d,[["__scopeId","data-v-0974f5a8"]]);var m=g,S=e(2483),y=e(3730),b=e(8533),v=e(943),w=e(9716),A=e(3567),T=e(1597),_=e(1010),k=e(5562);const R={class:"view-wrapper"},D={key:0,class:"primary-text"},I={key:1,class:"primary-text"},H={key:3,class:"gui"},N={key:0,class:"primary-text mt-5"},O={key:1,class:"primary-text mt-5"},E={class:"ship-container"};var U=(0,r.aZ)({__name:"PlaceShips",setup(t){const n=(0,a.o)(),e=(0,S.tv)(),i=(0,r.Fl)((()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)));function c(){const t=JSON.parse(JSON.stringify(n.player.board)),r=JSON.parse(JSON.stringify(n.computer.board));n.$reset(),n.setPlayerBoard(t),n.setComputerBoard(r);const o=Object.values(s.JY);(0,b.$x)(n.computer.board,o),n.setPlayerHasCurrentTurn(!0),e.push({name:"Game"})}return(t,e)=>((0,r.wg)(),(0,r.iD)("div",R,[(0,o.SU)(b.NU)((0,o.SU)(n).player)?((0,r.wg)(),(0,r.iD)("h1",D," Start Game ")):((0,r.wg)(),(0,r.iD)("h1",I," Place Your Ships ")),(0,r.Wm)(y.Z),(0,o.SU)(b.NU)((0,o.SU)(n).player)?((0,r.wg)(),(0,r.iD)("button",{key:2,onClick:c,class:"primary-button mt-5"}," Start Game ")):((0,r.wg)(),(0,r.iD)("div",H,[(0,o.SU)(i)?((0,r.wg)(),(0,r.iD)("h2",N," Tap on a ship and tap the board to place it ")):((0,r.wg)(),(0,r.iD)("h2",O," Drag a ship and drop it on the board to place it ")),(0,r._)("div",E,[(0,r.Wm)(m,{"ship-name":(0,o.SU)(s.JY).AIRCRAFT_CARRIER},{default:(0,r.w5)((()=>[(0,r.Wm)(k.Z)])),_:1},8,["ship-name"]),(0,r.Wm)(m,{"ship-name":(0,o.SU)(s.JY).SUBMARINE},{default:(0,r.w5)((()=>[(0,r.Wm)(v.Z)])),_:1},8,["ship-name"]),(0,r.Wm)(m,{"ship-name":(0,o.SU)(s.JY).DESTROYER},{default:(0,r.w5)((()=>[(0,r.Wm)(A.Z)])),_:1},8,["ship-name"]),(0,r.Wm)(m,{"ship-name":(0,o.SU)(s.JY).BATTLESHIP},{default:(0,r.w5)((()=>[(0,r.Wm)(T.Z)])),_:1},8,["ship-name"]),(0,r.Wm)(m,{"ship-name":(0,o.SU)(s.JY).FRIGATE},{default:(0,r.w5)((()=>[(0,r.Wm)(_.Z)])),_:1},8,["ship-name"]),(0,r.Wm)(m,{"ship-name":(0,o.SU)(s.JY).SUPPLY_BOAT},{default:(0,r.w5)((()=>[(0,r.Wm)(w.Z)])),_:1},8,["ship-name"])])]))]))}});const C=(0,p.Z)(U,[["__scopeId","data-v-16da5694"]]);var J=C}}]);
//# sourceMappingURL=484.6536c65b.js.map