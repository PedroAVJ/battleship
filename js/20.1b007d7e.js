"use strict";(self["webpackChunkbattleship"]=self["webpackChunkbattleship"]||[]).push([[20],{8533:function(t,e,n){n.d(e,{$x:function(){return d},NU:function(){return a},_1:function(){return v},_Q:function(){return p},_v:function(){return i},bw:function(){return g},cD:function(){return w},f0:function(){return s},gg:function(){return y},gr:function(){return f},hk:function(){return b},m9:function(){return h},we:function(){return S},zA:function(){return m}});n(7658);var o=n(8897),r=n(1084);function i(t){return new Promise((e=>setTimeout(e,t)))}function a(t){let e=!0;return Object.values(o.JY).forEach((n=>{t[n].guiCount>0&&(e=!1)})),e}function s(t){if(0===t.length)return!1;if(0===t[0].length)return!1;for(const e of t)for(const t of e)if(t.shipHitbox&&!t.contains.successfulShot)return!1;return!0}function l(t){for(const e of t)for(const t of e)if(!y(t))return!0;return!1}function c(t){if(s(t))throw new Error("Game is over, cannot make a move.");if(!l(t))throw new Error("No valid moves available.");const e=Math.floor(Math.random()*t.length),n=Math.floor(Math.random()*t[0].length);return y(t[e][n])?c(t):{row:e,col:n}}function u(t,e){const n=[];for(let i=0;i<r.y[t].length;i++)for(let a=0;a<r.y[t].width;a++)e===o.i5.HORIZONTAL&&n.push({row:a,col:i}),e===o.i5.VERTICAL&&n.push({row:i,col:a});return n}function f(t,e,n,o,r){const i=u(e,n);for(const a of i){if(a.row+o>=t.length)return!0;if(a.col+r>=t[0].length)return!0;const e=t[a.row+o][a.col+r];if(y(e))return!0;if(e.shipHitbox)return!0}return!1}function h(t,e,n,o,r){if(f(t,e,n,o,r))throw new Error("Invalid ship placement.");const i=u(e,n);for(const a of i){const i=t[a.row+o][a.col+r];i.shipHitbox=e;const s=0===a.row&&0===a.col;s&&(i.shipSprite={name:e,orientation:n,isPreview:!1})}}function d(t,e){e.forEach((e=>{for(let n=0;n<r.y[e].count;n++)while(1){const n=Math.floor(Math.random()*t.length),r=Math.floor(Math.random()*t[0].length),i=Math.random()<.5?o.i5.HORIZONTAL:o.i5.VERTICAL;if(!f(t,e,i,n,r)){h(t,e,i,n,r);break}}}))}function p(t,e){for(const n of t)for(const t of n)t.shipHitbox&&t.shipHitbox===e&&(t.contains.uncoveredShip=!0)}function g(t,e,n){for(let o=e-1;o<=e+1;o++)for(let e=n-1;e<=n+1;e++){if(o<0||o>=t.length)continue;if(e<0||e>=t[0].length)continue;const n=t[o][e];y(n)||(n.shipHitbox?n.contains.uncoveredShip=!0:n.contains.missedShot=!0)}}function m(t,e,n){for(let o=e-1;o<=e+1;o++)for(let e=n-1;e<=n+1;e++)b(t,o,e)}function b(t,e,n){if(e<0||e>=t.length)return;if(n<0||n>=t[0].length)return;const o=t[e][n];y(o)||(o.shipHitbox?o.contains.successfulShot=!0:o.contains.missedShot=!0)}function y(t){const e=t.background.isLand||t.background.isOutOfBounds||t.contains.missedShot||t.contains.successfulShot;return e}function S(t){if(!t[o.JY.BATTLESHIP].hasUsedAbility){const e=t[o.JY.BATTLESHIP].health;let n=.05;if(3===e?n=.1:2===e?n=.4:1===e&&(n=.8),Math.random()<n)return void(t[o.JY.BATTLESHIP].isUsingAbility=!0)}if(!t[o.JY.SUBMARINE].hasUsedAbility&&Math.random()<.1)t[o.JY.SUBMARINE].isUsingAbility=!0;else if(!t[o.JY.AIRCRAFT_CARRIER].hasUsedAbility){const e=t[o.JY.AIRCRAFT_CARRIER].health;let n=.05;if(6===e?n=.1:5===e?n=.15:4===e?n=.2:3===e?n=.3:2===e?n=.6:1===e&&(n=.9),Math.random()<n)return void(t[o.JY.AIRCRAFT_CARRIER].isUsingAbility=!0)}}function v(t){const e=[];for(let a=0;a<t.board.length;a++){e.push([]);for(let n=0;n<t.board[0].length;n++)e[a].push(0)}let n=JSON.parse(JSON.stringify(t.board));for(const a of n)for(const e of a)if(e.shipHitbox){e.shipSprite=void 0;const n=e.shipHitbox;0===t[n].health&&(e.contains.successfulShot=!1,e.contains.missedShot=!0),e.shipHitbox=void 0}for(let a=0;a<n.length;a++)for(let t=0;t<n[0].length;t++){const o=n[a][t];if(y(o))continue;let r=0;for(let e=a-1;e>=0;e--){if(!n[e][t].contains.successfulShot)break;r++}let i=0;for(let e=a+1;e<n.length;e++){if(!n[e][t].contains.successfulShot)break;i++}let s=0;for(let e=t-1;e>=0;e--){if(!n[a][e].contains.successfulShot)break;s++}let l=0;for(let e=t+1;e<n[0].length;e++){if(!n[a][e].contains.successfulShot)break;l++}e[a][t]=Math.max(r,i,s,l)}let o=0,r=-1,i=-1;for(let a=0;a<e.length;a++)for(let t=0;t<e[0].length;t++)e[a][t]>o&&(o=e[a][t],r=a,i=t);return 0===o?c(t.board):{row:r,col:i}}function w(t){const e=1e3,n=[];for(let o=0;o<t.board.length;o++){n.push([]);for(let e=0;e<t.board[0].length;e++)n[o].push(0)}const i=[];Object.values(o.JY).forEach((e=>{t[e].health>0&&i.push(e)})),i.sort(((t,e)=>{const n=r.y[t].length*r.y[t].width,o=r.y[e].length*r.y[e].width;return o-n}));let a=JSON.parse(JSON.stringify(t.board));for(const o of a)for(const t of o)t.shipHitbox=void 0,t.shipSprite=void 0;for(let o=0;o<e;o++){const t=JSON.parse(JSON.stringify(a));d(t,i);for(let e=0;e<t.length;e++)for(let o=0;o<t[0].length;o++){const r=t[e][o];r.shipHitbox&&n[e][o]++}}for(let o=0;o<n.length;o++)for(let t=0;t<n[0].length;t++)n[o][t]/=e;let s=0,l=-1,u=-1;for(let o=0;o<n.length;o++)for(let t=0;t<n[0].length;t++)n[o][t]>s&&(s=n[o][t],l=o,u=t);return 0===s?c(t.board):{row:l,col:u}}},3730:function(t,e,n){n.d(e,{Z:function(){return g}});var o=n(3396),r=n(4870),i=n(7139),a=n(9242),s=n(4299),l=n(7627),c=n(8533);const u={class:"board-wrapper"},f=["onDragenter","onDragleave","onDrop","onTouchstart","onTouchend"];var h=(0,o.aZ)({__name:"PlayerBoard",setup(t){const e=(0,l.o)();let n=null;function h(t,e,o){n=t.target,g(t,e,o)}function d(t,e,o){n===t.target&&(b(t,e,o),n=null)}function p(t){return t.background.isWater?"water":t.background.isLand?"land":t.background.isOutOfBounds?"out-of-bounds":void 0}function g(t,n,o){if(!(t.target instanceof HTMLElement))return;const r=e.currentlyDraggedShip?.name,i=e.currentlyDraggedShip?.orientation;if(!r||!i)return;const a=e.player.board;(0,c.gr)(a,r,i,n,o)||(a[n][o].shipSprite={name:r,orientation:i,isPreview:!0},t.target.classList.add("darken"))}function m(t,n,o){if(!(t.target instanceof HTMLElement))return;const r=e.currentlyDraggedShip?.name,i=e.currentlyDraggedShip?.orientation;if(!r||!i)return;const a=e.player.board;(0,c.gr)(a,r,i,n,o)||(a[n][o].shipSprite=void 0,t.target.classList.remove("darken"))}function b(t,n,o){if(!(t.target instanceof HTMLElement))return;const r=e.currentlyDraggedShip?.name,i=e.currentlyDraggedShip?.orientation;if(!r||!i)return;const a=e.player.board;(0,c.gr)(a,r,i,n,o)||((0,c.m9)(a,r,i,n,o),e.setPlayerShipGUICount(r,e.player[r].guiCount-1),t.target.classList.remove("darken"))}return(t,n)=>((0,o.wg)(),(0,o.iD)("div",u,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,r.SU)(e).player.board,((t,e)=>((0,o.wg)(),(0,o.iD)("div",{key:e,class:"board-row"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t,((t,r)=>((0,o.wg)(),(0,o.iD)("div",{key:r,class:"board-cell"},[(0,o._)("div",{class:(0,i.C_)(p(t)),onDragenter:t=>g(t,e,r),onDragleave:t=>m(t,e,r),onDragover:n[0]||(n[0]=(0,a.iM)((()=>{}),["prevent"])),onDrop:t=>b(t,e,r),onTouchstart:t=>h(t,e,r),onTouchend:t=>d(t,e,r)},[(0,o.Wm)(s.Z,{tile:t},null,8,["tile"])],42,f)])))),128))])))),128))]))}}),d=n(89);const p=(0,d.Z)(h,[["__scopeId","data-v-61b0d520"]]);var g=p},712:function(t,e,n){n.r(e),n.d(e,{default:function(){return C}});n(7658);var o=n(3396),r=n(4870),i=n(7139),a=n(7627),s=n(8897),l=n(1084);const c=["id"],u={class:"secondary-text"},f={class:"secondary-text"},h={class:"secondary-text"};var d=(0,o.aZ)({__name:"ShipItem",props:{shipName:null},setup(t){const e=t,n=(0,a.o)(),d=(0,r.iH)(s.i5.HORIZONTAL),p=(0,r.iH)(null);function g(t){t.target instanceof HTMLElement&&n.setCurrentlyDraggedShip(e.shipName,d.value)}function m(t){t.target instanceof HTMLElement&&n.setCurrentlyDraggedShip(e.shipName,d.value)}function b(t){t.target instanceof HTMLElement&&(t.target.style.position="",t.target.style.left="",t.target.style.top="",t.target.style.zIndex="")}function y(){d.value===s.i5.HORIZONTAL?d.value=s.i5.VERTICAL:d.value=s.i5.HORIZONTAL}return(0,o.YP)((()=>n.currentlyDraggedShip?.name),(t=>{t===e.shipName?p.value?.classList.add("selected"):p.value?.classList.remove("selected")})),(a,s)=>(0,r.SU)(n).player[t.shipName].guiCount>0?((0,o.wg)(),(0,o.iD)("div",{key:0,id:t.shipName,class:"secondary-background"},[(0,o._)("h2",u,(0,i.zw)(t.shipName),1),(0,o._)("div",{ref_key:"svgContainer",ref:p,class:"svg-container",draggable:"true",onDragstart:g,onTouchstart:m,onTouchend:b},[(0,o.WI)(a.$slots,"default")],544),(0,o._)("span",f," Tamaño: "+(0,i.zw)((0,r.SU)(l.y)[e.shipName].length)+" x "+(0,i.zw)((0,r.SU)(l.y)[e.shipName].width),1),(0,o._)("button",{class:(0,i.C_)(["primary-button",d.value]),onClick:y},(0,i.zw)(d.value),3),(0,o._)("span",h," Disponibles: x"+(0,i.zw)((0,r.SU)(n).player[t.shipName].guiCount),1)],8,c)):(0,o.kq)("",!0)}}),p=n(89);const g=(0,p.Z)(d,[["__scopeId","data-v-33185735"]]);var m=g,b=n(2483),y=n(3730),S=n(8533),v=n(943),w=n(9716),A=n(3567),T=n(1597),_=n(1010),k=n(5562);const R={class:"view-wrapper"},D={key:0,class:"primary-text"},I={key:1,class:"primary-text"},E={key:3,class:"gui"},H={key:0,class:"primary-text mt-5"},N={key:1,class:"primary-text mt-5"},O={class:"ship-container"};var U=(0,o.aZ)({__name:"PlaceShips",setup(t){const e=(0,a.o)(),n=(0,b.tv)(),i=(0,o.Fl)((()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)));function l(){const t=JSON.parse(JSON.stringify(e.player.board)),o=JSON.parse(JSON.stringify(e.computer.board));e.$reset(),e.setPlayerBoard(t),e.setComputerBoard(o);const r=Object.values(s.JY);(0,S.$x)(e.computer.board,r),e.setPlayerHasCurrentTurn(!0),n.push({name:"Game"})}return(t,n)=>((0,o.wg)(),(0,o.iD)("div",R,[(0,r.SU)(S.NU)((0,r.SU)(e).player)?((0,o.wg)(),(0,o.iD)("h1",D," Empezar Juego ")):((0,o.wg)(),(0,o.iD)("h1",I," Coloca tus naves ")),(0,o.Wm)(y.Z),(0,r.SU)(S.NU)((0,r.SU)(e).player)?((0,o.wg)(),(0,o.iD)("button",{key:2,onClick:l,class:"primary-button mt-5"}," Empezar Juego ")):((0,o.wg)(),(0,o.iD)("div",E,[(0,r.SU)(i)?((0,o.wg)(),(0,o.iD)("h2",H," Toca un barco y toca el tablero para colocarlo ")):((0,o.wg)(),(0,o.iD)("h2",N," Arrastra un barco y suéltalo en el tablero para colocarlo ")),(0,o._)("div",O,[(0,o.Wm)(m,{"ship-name":(0,r.SU)(s.JY).AIRCRAFT_CARRIER},{default:(0,o.w5)((()=>[(0,o.Wm)(k.Z)])),_:1},8,["ship-name"]),(0,o.Wm)(m,{"ship-name":(0,r.SU)(s.JY).SUBMARINE},{default:(0,o.w5)((()=>[(0,o.Wm)(v.Z)])),_:1},8,["ship-name"]),(0,o.Wm)(m,{"ship-name":(0,r.SU)(s.JY).DESTROYER},{default:(0,o.w5)((()=>[(0,o.Wm)(A.Z)])),_:1},8,["ship-name"]),(0,o.Wm)(m,{"ship-name":(0,r.SU)(s.JY).BATTLESHIP},{default:(0,o.w5)((()=>[(0,o.Wm)(T.Z)])),_:1},8,["ship-name"]),(0,o.Wm)(m,{"ship-name":(0,r.SU)(s.JY).FRIGATE},{default:(0,o.w5)((()=>[(0,o.Wm)(_.Z)])),_:1},8,["ship-name"]),(0,o.Wm)(m,{"ship-name":(0,r.SU)(s.JY).SUPPLY_BOAT},{default:(0,o.w5)((()=>[(0,o.Wm)(w.Z)])),_:1},8,["ship-name"])])]))]))}});const J=(0,p.Z)(U,[["__scopeId","data-v-3e628d0b"]]);var C=J}}]);
//# sourceMappingURL=20.1b007d7e.js.map